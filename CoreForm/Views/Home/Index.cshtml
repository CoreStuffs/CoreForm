@{
    ViewData["Title"] = "CoreForm";
}

<div class="text-center">
    <h1 class="display-4">Available forms</h1>
</div>


<div class="uk-child-width-1-3@l  uk-child-width-1-2@m uk-child-width-1-1@s uk-grid-small uk-grid-match" uk-grid>
    @foreach (var item in Model.FormModels)
    {
    <div class="uk-card uk-card-hover uk-card-body">
        <a class="uk-link-heading uk-card-title" href="/form/@item.CurrentVersion.Id/render">@(item.CurrentVersion.Name??"Unknown")</a>
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.</p>
        <div class="uk-flex uk-flex-right">
            <div class="uk-margin-left"><a class="uk-link-muted" uk-icon="icon: play" href="/form/@item.CurrentVersion.Id/render">Launch</a></div>
            <div class="uk-margin-left"><a class="uk-link-muted" uk-icon="icon: pencil" href="/form/@item.Id/build">Edit</a></div>
        </div>
    </div>
    }
</div>


    <a class="btn btn-primary" href="#createNewModelModal" uk-toggle>New Form Schema</a>


    <div id="createNewModelModal" uk-modal>
        <div class="uk-modal-dialog">

            <button class="uk-modal-close-default" type="button" uk-close></button>
            <div class="uk-modal-header">
                <h2 class="uk-modal-title">New model</h2>
            </div>
            <div class="uk-modal-body">
                <form>
                    <div class="form-group">
                        <label for="modelName" class="col-form-label">Name:</label>
                        <input type="text" class="form-control" id="modelName">
                    </div>
                </form>
            </div>
            <div class="uk-modal-footer">
                <button type="button" class="uk-button uk-button-default uk-modal-close">Close</button>
                <button type="button" id="createNewModelModal_OK" class="uk-button uk-button-primary">Create and Edit</button>

            </div>

        </div>
    </div>

    @section Scripts{
        <script>
        $('#createNewModelModal').on('show.bs.modal', function (event) {
            // var button = $(event.relatedTarget) // Button that triggered the modal
            //var recipient = button.data('whatever') // Extract info from data-* attributes
            // If necessary, you could initiate an AJAX request here (and then do the updating in a callback).
            // Update the modal's content. We'll use jQuery here, but you could use a data binding library or other methods instead.
            var modal = $(this);
            //modal.find('.modal-title').text('New message to ' + recipient);
            //modal.find('.modal-body input').val("")
        })

        $('#createNewModelModal_OK').on('click', function (e) {
                var modal = UIkit.modal('#createNewModelModal');
                var name = modal.find('.modal-body input').val();
                modal.hide();
                 $.ajax('@Url.Content("Form/NewModel")', {
                     data: JSON.stringify({Name:name}),
                        contentType: 'application/json',
                     type: 'POST',
                        success: function(data){
                            window.location.href = "/Form/" + data + "/build";
                         }
                    });


            })


        </script>



    }
